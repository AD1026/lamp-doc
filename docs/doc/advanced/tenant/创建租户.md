---
title: 创建租户
index: false
category:
  - 开发进阶
tag:
  - 开发进阶
  - 创建租户
---

<!-- #region backend_flow -->

## 后台创建租户流程

大致流程为：新增租户->初始化租户数据库表结构和初始数据->初始化其他服务的数据源

![](/images/intro/创建租户&成为企业流程.drawio.png)

1. 点击**新增**按钮， 弹出新增页面，填写租户（企业）名称，填完信息后，点击确定按钮。

   字段解释：

    - 有效期：在有效期内,才能登录使用。(别人申请试用时，可以设置为试用时间)

2. 保存成功后，租户状态变为**待初始化结构**状态。

   此时租户还不可用。

   ![](/images/intro/操作_租户管理_待初始化结构.png)

3. 点击**初始化租户数据库表结构和初始数据**弹出初始化表单，根据业务选择连接类型，点击确认按钮进行初始化。

   - 系统内置数据源：程序会在系统自己的数据库中，创建租户自己的数据库实例进行初始化表和初始数据。执行此操作后，system-server 会自动创建租户库lamp_base_{租户ID}，并在此数据库中自动创建表，插入初始数据。

     ![](/images/intro/操作_租户管理_初始化数据源.png)

   - 自定义数据源：程序使用指定的数据库进行初始化表和初始数据，该类型需要提前在**数据源维护**页面创建好数据库。

     ![](/images/intro/操作_租户管理_初始化数据源_自定义.png)

4. 执行完**初始化租户数据库表结构和初始数据**后，审核状态变成**待初始化数据源**状态。

   ![](/images/intro/操作_租户管理_待初始化数据源.png)

5. 点击**初始化其他服务的数据源**弹出操作界面，将**未链接**状态的服务点击**立即链接**按钮，使lamp-base-server和lamp-oauth-server服务连上数据源

   ![](/images/intro/操作_租户管理_初始化链接.png)

6. 待所有服务的状态的变成**已链接**后，点击上图右下方==确认==按钮，将租户状态更新为“正常”状态

   ![](/images/intro/操作_租户管理_正常.png)

7. 此时该租户还尚无账号，需要绑定一个租户管理员。点击**绑定租户管理员**按钮弹出操作框后，选择一个用户，将其设置为此租户的管理员。

   ![](/images/intro/操作_租户管理_绑定用户.png)

8. 绑定成功后，该用户就可以登录系统

   此时用户登录后，只有**基础平台**一个应用可使用，若需要使用已经开发好的其他应用，需要对此租户进行应用授权，操作流程见**应用授权管理**

<!-- #endregion backend_flow -->

<!-- #region flow -->
## 申请成为企业流程

大致流程为：申请成为企业->审核（初始化租户数据库表结构和初始数据）->初始化其他服务的数据源

1. 普通用户注册账号，并登录系统。

2. 普通用户进入**我的企业**菜单，点击**申请创建自己的企业**，填写企业信息。 填写完成后，企业状态变成 **待审核**状态。

   - 申请

     ![](/images/intro/操作_我的企业_申请.png)

   - 待审核状态

     ![](/images/intro/操作_我的企业_待审核.png)

3. 运营者登录系统，进入**租户维护**页面，点击**审核**按钮，弹出审核页面，选择**同意**并提交，企业审核成功后变成**待初始化数据源**状态

   ![](/images/intro/操作_租户维护_审核.png)

4. 审核同意后，还需要执行**初始化其他服务的数据源**操作。

   ![](/images/intro/操作_租户管理_待初始化数据源.png)

5. 点击**初始化其他服务的数据源**弹出操作界面，将**未链接**状态的服务点击**立即链接**按钮，使lamp-base-server和lamp-oauth-server服务连上数据源。

   ![](/images/intro/操作_租户管理_初始化链接.png)

6. 待所有服务的状态的变成**已链接**后，说明此租户已经可以正常使用了。

   ![](/images/intro/操作_租户管理_正常.png)

7. 此时租户下还尚无账号，需要给其绑定一个租户管理员。点击**绑定租户管理员**按钮弹出操作框后，选择一个用户，将其设置为此租户的管理员。

   ![](/images/intro/操作_租户管理_绑定用户.png)

8. 绑定成功后，即可通知用户登录系统

<!-- #endregion flow -->
